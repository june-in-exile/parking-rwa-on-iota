{
  "version": 3,
  "sources": ["../../src/utils.ts"],
  "sourcesContent": ["// Copyright (c) Mysten Labs, Inc.\n// Modifications Copyright (c) 2025 IOTA Stiftung\n// SPDX-License-Identifier: Apache-2.0\n\nconst LABEL_REGEX = /(?!-)[a-z0-9-]{0,62}[a-z0-9]/;\nconst SUBNAME_REGEX = /^(?!-)[a-z0-9-]{1,62}[a-z0-9]$/;\nconst PATH_REGEX = new RegExp(`(?:${LABEL_REGEX.source}(?:\\\\.${LABEL_REGEX.source})*)`);\nconst NAME_AT_REGEX = new RegExp(`^(${PATH_REGEX.source})?@${LABEL_REGEX.source}$`);\nconst NAME_DOT_REGEX = new RegExp(`^(?:${LABEL_REGEX.source}\\\\.)+(iota)$`);\nconst MAX_LENGTH = 235;\n\nexport function isValidIotaName(name: string): boolean {\n    if (name.length > MAX_LENGTH) {\n        return false;\n    }\n\n    return NAME_AT_REGEX.test(name) || NAME_DOT_REGEX.test(name);\n}\n\nconst LONG_NAMES_TRUNCATE_LENGTH = 11;\nconst CHARACTERS_TO_SHOW = 6;\n\ninterface NormalizeOptions {\n    onlyFirstSubname?: boolean;\n    truncateLongParts?: boolean;\n    ellipsisForDeepSubnames?: boolean;\n}\n\nexport function normalizeIotaName(\n    name: string,\n    format: 'at' | 'dot' = 'at',\n    {\n        onlyFirstSubname,\n        truncateLongParts,\n        ellipsisForDeepSubnames = onlyFirstSubname === true,\n    }: NormalizeOptions = {},\n): string {\n    const lowerCase = name.toLowerCase();\n    let parts;\n\n    // Split in parts\n    if (NAME_AT_REGEX.test(lowerCase)) {\n        let [path, name] = lowerCase.split('@');\n        parts = [...(path ? path.split('.') : []), name];\n    } else if (NAME_DOT_REGEX.test(lowerCase)) {\n        parts = lowerCase.split('.').slice(0, -1);\n    } else {\n        throw new Error(`Invalid IOTA name \"${name}\"`);\n    }\n\n    const subnamesEllipsis = format === 'dot' ? '.' : '..';\n\n    // Only select the first subname if desired\n    let subnames =\n        onlyFirstSubname && parts.length >= 2\n            ? [\n                  // First name from the left (e.g yes.no.no.no.iota)\n                  parts[0],\n                  ellipsisForDeepSubnames && parts.length > 2 ? subnamesEllipsis : '',\n              ].filter(Boolean)\n            : parts.slice(0, -1);\n\n    let parentName = parts[parts.length - 1];\n\n    if (truncateLongParts) {\n        subnames = subnames.map((s) => {\n            return s.length > LONG_NAMES_TRUNCATE_LENGTH\n                ? `${s.slice(0, CHARACTERS_TO_SHOW)}...${s.slice(-CHARACTERS_TO_SHOW)}`\n                : s;\n        });\n\n        parentName =\n            parentName.length > LONG_NAMES_TRUNCATE_LENGTH\n                ? `${parentName.slice(0, CHARACTERS_TO_SHOW)}...${parentName.slice(-CHARACTERS_TO_SHOW)}`\n                : parentName;\n    }\n\n    // Construct name\n    if (format === 'dot') {\n        return `${[...subnames, parentName].join('.')}.iota`;\n    } else {\n        return `${subnames.join('.')}@${parentName}`;\n    }\n}\n\nexport function validateIotaSubname(\n    name: string,\n    minLength: number = 3,\n    maxLength: number = 64,\n): string | null {\n    if (!name) return null;\n    const lowerCase = name.toLowerCase();\n\n    if (name.length < minLength || name.length > maxLength) {\n        return `Name must be ${minLength}-${maxLength} characters long`;\n    }\n    if (!SUBNAME_REGEX.test(lowerCase)) {\n        return 'Invalid characters. Only a-z, 0-9, and hyphens (not at the beginning or end) are allowed';\n    }\n    return null;\n}\n\nexport function validateIotaName(\n    name: string,\n    minLength: number = 3,\n    maxLength: number = 64,\n    allowSubnames: boolean = true,\n): string | null {\n    if (!name) return null;\n    const lowerCase = name.toLowerCase();\n\n    const parts = lowerCase.split('.');\n\n    if (!allowSubnames && parts.length > 2) {\n        return 'No subnames allowed';\n    }\n    for (const part of parts.slice(0, -1)) {\n        if (part.length < minLength || part.length > maxLength) {\n            return `Name must be ${minLength}-${maxLength} characters long`;\n        }\n    }\n    if (!NAME_DOT_REGEX.test(name)) {\n        return 'Invalid characters. Only a-z, 0-9, and hyphens (not at the beginning or end) are allowed';\n    }\n    return null;\n}\n"],
  "mappings": "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",
  "names": ["name"]
}
